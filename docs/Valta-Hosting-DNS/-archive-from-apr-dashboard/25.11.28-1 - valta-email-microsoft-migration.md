# Session Summary: Valta Email Microsoft Migration

**Date:** November 28, 2025
**Project:** APR-Dashboard-v3 - Email & Domain Management
**Session:** #1
**Topic:** valta-email-microsoft-migration

---

## Context

Worked on migrating Valta.ca email from Google Workspace to Microsoft 365, including DNS management transition from Vercel to GoDaddy for easier IT team management.

### Current Setup Discovered
- **Email:** Google Workspace (admin@valta.ca, chris@valta.ca)
- **DNS Management:** Vercel (nameservers: ns1.vercel-dns.com, ns2.vercel-dns.com)
- **Website Hosting:** Vercel (staying - performance/dev workflow)
- **Domain Registrar:** GoDaddy
- **Email Sending:** Resend API (works with any email provider)

### Previous Documentation Found
- Old APR Hub: `/01-APR-Hub-MAIN/_APR-Hub-Master/02-Credentials/GMAIL-ADMIN-CREDENTIALS.md`
- Valta Website: `/Valta-Website/docs/hosting-and-dns.md`
- Current v3: Resend integration in `/supabase/functions/send-loe-email-fixed/`

---

## Decisions Made

### 1. Keep Website Hosting on Vercel
**Why:**
- Fast global CDN (100+ locations)
- Perfect for development workflow with Claude Code
- Git push = automatic deployment
- Free tier with auto-SSL
- Much better than GoDaddy hosting

### 2. Move DNS Management to GoDaddy
**Why:**
- IT team can manage email without Vercel access
- Centralized management for email + DNS
- Simpler for ongoing email administration
- Clean separation: email (GoDaddy) + website (Vercel)

### 3. Migrate from Google to Microsoft 365
**Why:**
- Chris wants to move away from Google
- IT team preference for Microsoft ecosystem
- Better integration with business tools

### 4. IT Person Handles Migration (No Vercel Access)
**Why:**
- Security - no need for full Vercel account access
- Simplicity - IT person works in familiar GoDaddy
- Delegation - IT team owns email, dev team owns website

---

## Deliverables Created

### 1. Email-Godaddy-admin.md
**Location:** `/docs/02-Email-&-Pipedrive-CRM/Domain-DNS-Email-Godaddy/Email-Godaddy-admin.md`

**Contents:**
- Complete migration plan overview
- Current setup documentation
- 4-phase migration process
- DNS architecture diagrams
- Timeline estimates (2-4 days)
- Access & credentials information

### 2. IT-HANDOFF-INSTRUCTIONS.md
**Location:** `/docs/02-Email-&-Pipedrive-CRM/Domain-DNS-Email-Godaddy/IT-HANDOFF-INSTRUCTIONS.md`

**Contents:**
- Professional IT guide (streamlined, no hand-holding)
- All DNS record values needed (no Vercel access required)
- 4 migration phases with exact technical specs
- Critical warnings about website hosting
- Final DNS state reference

**Revisions:**
- Removed troubleshooting section
- Removed detailed checklists
- Streamlined for professional IT person
- Enhanced overview with current state and goals

---

## Technical Details Documented

### DNS Records for Migration

**Website Records (Points to Vercel - DO NOT CHANGE):**
```
Type: A | Name: @ | Value: 76.76.21.21
Type: CNAME | Name: www | Value: cname.vercel-dns.com
```

**Email Records (Google - Temporary):**
```
Type: MX | Name: @ | Value: aspmx.l.google.com | Priority: 1
Type: MX | Name: @ | Value: alt1.aspmx.l.google.com | Priority: 5
Type: MX | Name: @ | Value: alt2.aspmx.l.google.com | Priority: 5
Type: MX | Name: @ | Value: alt3.aspmx.l.google.com | Priority: 10
Type: MX | Name: @ | Value: alt4.aspmx.l.google.com | Priority: 10
```

**Email Records (Microsoft - Final):**
```
Type: MX | Name: @ | Value: valta-ca.mail.protection.outlook.com | Priority: 0
Type: TXT | SPF, DKIM, DMARC (per Microsoft instructions)
```

### Current Email Credentials
- **Email:** admin@valta.ca
- **Provider:** Google Workspace
- **Password:** Emailcircle1estates!
- **App Password (SMTP):** spusouthiyfmesdj
- **SMTP Server:** smtp.gmail.com (ports 587/465)

---

## Problems Solved

### 1. Nameservers vs Email Hosting Confusion
**Problem:** User unsure how nameservers relate to email
**Solution:** Explained nameservers = where DNS is managed (not where email is purchased)
**Key Insight:** Nameservers point to DNS management location, MX records route email

### 2. Which Project Has Email Config?
**Problem:** Old APR Hub vs new APR-Dashboard-v3
**Solution:**
- Email credentials documented in old APR Hub
- Resend sending integration in new v3 project
- Resend is provider-agnostic (works with Google or Microsoft)

### 3. How to Avoid Email Downtime
**Problem:** Switching nameservers could break email
**Solution:** Pre-add all DNS records in GoDaddy BEFORE changing nameservers
**Timeline:** Add records → change nameservers → smooth transition

### 4. IT Person Access Requirements
**Problem:** Does IT person need Vercel access?
**Solution:** NO - provided all DNS values in handoff doc
**Benefit:** Security + simplicity, IT person works only in GoDaddy

---

## Migration Phases Overview

### Phase 1: Configure DNS in GoDaddy (30 min + 6-24 hr propagation)
1. Pre-add website records (A, CNAME to Vercel)
2. Pre-add Google MX records (temporary)
3. Change nameservers from Vercel to GoDaddy
4. Wait for propagation

### Phase 2: Microsoft 365 Setup (1-2 hours)
1. Create Microsoft 365 Business account
2. Add valta.ca domain
3. Verify domain (TXT record in GoDaddy)
4. Create email accounts (admin@valta.ca, chris@valta.ca)
5. Assign licenses

### Phase 3: Cutover to Microsoft (15 min + 1 hr propagation)
1. Remove Google MX records from GoDaddy
2. Add Microsoft MX record
3. Add SPF/DKIM/DMARC records
4. Test email (inbound/outbound)

### Phase 4: Email Migration - Optional (2-24 hours)
1. Use Microsoft 365 migration tool
2. Migrate emails, contacts, calendars from Google
3. Verify data transfer

---

## Key Learnings

### Architecture Separation
- **Email + DNS:** Managed together in GoDaddy (IT team)
- **Website Hosting:** Stays on Vercel (dev team)
- **Clean boundaries:** Each team manages their domain

### Development Workflow Preservation
- Vercel hosting essential for:
  - Git integration (push = deploy)
  - Claude Code development workflow
  - Global CDN performance
  - Automatic SSL/previews
- GoDaddy hosting would break this workflow

### Resend Email Service
- Provider-agnostic sending service
- Works with Google, Microsoft, or any SMTP
- No changes needed after migration
- Currently: `re_T2VGRdd3_CqZuH9XCBrjxJuNPyQwykHJp`

### Safe DNS Migration Pattern
1. Pre-configure all records at destination
2. Change nameservers (single switch)
3. Minimal/zero downtime
4. Easy rollback if needed

---

## Next Actions

### Immediate (Ben)
- [x] Create migration documentation
- [x] Create IT handoff guide
- [ ] Share IT-HANDOFF-INSTRUCTIONS.md with Chris's IT person
- [ ] Provide GoDaddy login credentials to IT person

### IT Person Responsibilities
- [ ] Pre-add DNS records in GoDaddy
- [ ] Change nameservers to GoDaddy
- [ ] Setup Microsoft 365 account
- [ ] Verify valta.ca domain in Microsoft
- [ ] Create email accounts
- [ ] Switch MX records to Microsoft
- [ ] Test email functionality
- [ ] Migrate email data (optional)
- [ ] Cancel Google Workspace subscription

### Future Considerations
- Monitor email delivery during migration
- Update any hardcoded email configs in APR Dashboard v3
- Consider Vercel account ownership transfer for Chris (website hosting)
- Document final email configuration after migration complete

---

## Search Keywords

**For Future Agents:**
- valta.ca, admin@valta.ca, chris@valta.ca
- Google Workspace, Microsoft 365, email migration
- Vercel DNS, GoDaddy DNS, nameservers
- MX records, SPF, DKIM, DMARC
- Resend API, email sending service
- IT handoff, migration plan
- Domain DNS Email GoDaddy
- APR-Dashboard-v3 email configuration

---

## Files Modified/Created

```
/APR-Dashboard-v3/docs/02-Email-&-Pipedrive-CRM/Domain-DNS-Email-Godaddy/
├── Email-Godaddy-admin.md [CREATED]
├── IT-HANDOFF-INSTRUCTIONS.md [CREATED]
└── -passover-sessions/
    └── 25.11.28-1 - valta-email-microsoft-migration.md [THIS FILE]
```

---

## Timeline Summary

**Total Migration Time:** 2-4 days

- **Phase 1:** 30 min work + 6-24 hr propagation
- **Phase 2:** 1-2 hours setup
- **Phase 3:** 15 min work + 1 hr propagation
- **Phase 4:** 2-24 hours (optional email data migration)

---

**Session Completed:** November 28, 2025 at 14:50
**Status:** Ready for IT person handoff
**Next Session:** Post-migration verification and documentation update
